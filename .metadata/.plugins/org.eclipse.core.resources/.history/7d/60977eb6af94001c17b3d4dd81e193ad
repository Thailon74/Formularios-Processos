<!DOCTYPE html>
<html>

<head>
	<title>Form</title>

	<link rel="stylesheet" type="text/css" href="https://parkssa127265.fluig.cloudtotvs.com.br/style-guide/css/fluig-style-guide.min.css">
	<script src="/resources/js/jquery/jquery.js"></script>
	<script src="/resources/js/jquery/jquery-ui.min.js"></script>
	<script src="/resources/js/mustache/mustache-min.js"></script>
	<script src="/style-guide/js/fluig-style-guide.min.js"></script>
	<script type="text/javascript" src="/webdesk/vcXMLRPC.js" charset="utf-8"></script>

	<!-- CUSTOM -->
	<link href="/style-guide/css/fluig-style-guide-filter.min.css" rel="stylesheet" type="text/css">
	<link href="/style-guide/css/fluig-style-guide-ratingstars.min.css" rel="stylesheet" type="text/css">
	<script src="/style-guide/js/fluig-style-guide-filter.min.js"></script>
	<script src="/style-guide/js/fluig-style-guide-ratingstars.min.js"></script>

	<link href='/webdesk/customresources?cid=1&resourceName=temaFormulario/0.css' type='text/css' rel='stylesheet' />
</head>

<body class="fluig-style-guide">

	<form class="totvs-form grid vertical create-form-components ui-sortable t0" name="createFormComponents"
		style="padding-left: 10px; padding-right: 10px;">
		<h1 class="title-form-application">Formulário de Solicitação de Alteração</h1>
		<div class="paragraph-is-required system-message-information alert alert-info" role="alert">Todos os campos com
			* são de preenchimento obrigatório.</div>
		<div class="form-field" data-type="zoomfield" data-show-properties="" data-field-name="aprovador"
			style="position: relative; left: 0px; top: 0px;">
			<div class="form-input">
				<div class="form-group">
					<label for="zoom">Selecione o aprovador da SA</label>
					<div class="input-group">
						<input type="zoom" class="form-control" name="aprovador"
							dataset="colleague" zoomvalue="colleagueId" datasetvalue="colleagueName"
							data-zoom="{'displayKey':'colleagueName','datasetId':'colleague','fields':[{'field':'colleagueName','label':'colleagueName','standard':true}]}">
						<div class="input-group-addon zoom-preview">
							<span class="fluigicon fluigicon-zoom-in"></span>
						</div>
						<input type="hidden" name="hidden_aprovador" id="hidden_aprovador">
					</div>
				</div>
			</div>
		</div>
		<div class="form-field" data-type="textbox" data-show-properties="" data-field-name="tituloSA">
			<div class="form-input">
				<div class="form-group"><label>Título da SA</label><span
						class="required text-danger"><strong>*</strong></span><input type="text" class="form-control"
						name="tituloSA" value=""
						placeholder="Digite um título que dê uma indicação de qual produto e qual alteração a solicitação se refere"
						data-size="big" required="required"></div>
			</div>
		</div>
		<label>Código do produto</label>
		<span class="required text-danger">
			<strong>*</strong>
		</span>
		<div class = "row">
			<div class="form-field" data-type="textbox" data-show-properties="" data-field-name="codProduto">
				<div class="form-input">
					<div class="form-group ">
						<div class="input-group">
							<div class="col-md-10">
								<input type="zoom" class="form-control" name="codProduto" dataset="ds_Itens" zoomvalue="it-codigo" datasetvalue="it-codigo" data-zoom="{
									'displayKey':'it-codigo',
									'datasetId':'ds_Itens',
									'placeholder':'Escolha os produtos',
									'resultLimit':'3000',
									'fields':[
										{
										   'field':'it-codigo',
										   'label':'Cod-item'
										   'standard':'true'
										},{
										  'field':'descricao',
										  'label':'Descrição',
										}
									]
								 }">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="form-field" data-type="textarea" data-show-properties="" data-field-name="descAlteracao"
			style="position: relative; left: 0px; top: 0px;">
			<div class="form-input">
				<div class="form-group"><label>Descrição da Alteração</label><span
						class="required text-danger"><strong>*</strong></span><textarea class="form-control" rows="3"
						name="descAlteracao" placeholder="" data-size="big" required="required"></textarea></div>
			</div>
		</div>
		<div class="form-field" data-type="checkbox" data-show-properties="" data-field-name="motivocheck">
			<div class="form-input">
				<div class="form-group"><label>Motivo</label>
					<div class="check-options">
						<div class="checkbox"><label><input type="checkbox" name="checkbox30"
									value="Correção">Correção</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox31"
									value="Melhoria">Melhoria</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox32"
									value="Redução de Custos">Redução de Custos</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox33"
									value="Suprimentos">Suprimentos</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox34"
									value="Processos">Processos</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox35"
									value="Documentação">Documentação</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox36"
									value="Outros">Outros</label></div>
					</div>
				</div>
			</div>
		</div>
		<div class="form-field" data-type="textarea" data-show-properties="" data-field-name="text_justificat"
			style="position: relative; left: 0px; top: 0px;">
			<div class="form-input">
				<div class="form-group"><label>Justificativa</label><span
						class="required text-danger"><strong>*</strong></span><textarea class="form-control" rows="3"
						name="text_justificat"
						placeholder="Insira aqui a razão para essa alteração estar sendo solicitada. Que problema ela resolve?"
						data-size="big" required="required"></textarea></div>
			</div>
		</div>
		<div class="form-field" data-type="checkbox" data-show-properties="" data-field-name="check_classe"
			style="position: relative; left: 0px; top: 0px;">
			<div class="form-input">
				<div class="form-group"><label>Classe</label>
					<div class="check-options">
						<div class="checkbox"><label><input type="checkbox" name="checkbox50"
									value="Afeta produtos em campo">Afeta produtos em campo</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox51"
									value="Afeta produtos no estoque">Afeta produtos no estoque</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox52"
									value="Afeta produtos em processo">Afeta produtos em processo</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox53"
									value="Afeta produtos futuros">Afeta produtos futuros</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox54"
									value="Afeta produtos que retornam p/ RMA">Afeta produtos que retornam p/
								RMA</label></div>
						<div class="checkbox"><label><input type="checkbox" name="checkbox55" value="Não aplicável">Não
								aplicável</label></div>
					</div>
				</div>
			</div>
		</div>
		<div class="form-field" data-type="radio" data-show-properties="" data-field-name="radio_par_aprov">
			<div class="form-input">
				<div class="form-group"><label>Parecer do aprovador</label>
					<div class="radio-options">
						<div class="radio"><label><input type="radio" name="radio_par_aprov"
									value="Aprovada">Aprovada</label></div>
						<div class="radio"><label><input type="radio" name="radio_par_aprov"
									value="Solicitar revisão">Solicitar revisão</label></div>
						<div class="radio"><label><input type="radio" name="radio_par_aprov"
									value="Reprovada">Reprovada</label></div>
					</div>
				</div>
			</div>
		</div>
		<div class="form-field" data-type="textbox" data-show-properties="" data-field-name="text_com_aprov"
			style="position: relative; left: 0px; top: 0px;">
			<div class="form-input">
				<div class="form-group"><label>Comentários do aprovador</label><input type="text" class="form-control"
						name="text_com_aprov" value=""
						placeholder="Em caso de revisão ou reprovação, insira aqui o motivo." data-size="big"></div>
			</div>
		</div>
		<div class="form-field" data-type="radio" data-show-properties="" data-field-name="radio_par_exec">
			<div class="form-input">
				<div class="form-group"><label>Parecer do executor</label>
					<div class="radio-options">
						<div class="radio"><label><input type="radio" name="radio_par_exec"
									value="SA liberada no sistema">SA liberada no sistema</label></div>
						<div class="radio"><label><input type="radio" name="radio_par_exec"
									value="Solicitar revisão">Solicitar revisão</label></div>
					</div>
				</div>
			</div>
		</div>
		<div class="form-field" data-type="textbox" data-show-properties="" data-field-name="text_com_exec"
			style="position: relative; left: 0px; top: 0px;">
			<div class="form-input">
				<div class="form-group"><label>Comentários do executor</label><input type="text" class="form-control"
						name="text_com_exec" value="" placeholder="" data-size="big"></div>
			</div>
		</div>
	</form>


	<script type="text/javascript">
		
		let ds = DatasetFactory.getDataset('ds_Itens')

		console.log('ds',ds)

		var keyDown = false, ctrl = 17, vKey = 86, Vkey = 118;

		$(document).keydown(function (e) {
			if (e.keyCode == ctrl) keyDown = true;
		}).keyup(function (e) {
			if (e.keyCode == ctrl) keyDown = false;
		});

		$('[data-only-numbers]').on('keypress', function (e) {
			if (!e) {
				var e = window.event;
			}

			if (e.keyCode > 0 && e.which == 0) {
				return true;
			}

			if (e.keyCode) {
				code = e.keyCode;
			} else if (e.which) {
				code = e.which;
			}

			if (code == 46) {
				return true;
			}

			var character = String.fromCharCode(code);
			if (character == '\b' || character == ' ' || character == '\t') {
				return true;
			}
			if (keyDown && (code == vKey || code == Vkey)) {
				return (character);
			} else {
				return (/[0-9]$/.test(character));
			}
		}).on('focusout', function (e) {
			var $this = $(this);
			if ($this.val() == "") {
				return true;
			}
			$this.val($this.val().replace(/[^0-9\.]/g, ''));
		}).on('paste', function (e) {
			var $this = $(this);
			setTimeout(function () {
				$this.val($this.val().replace(/[^0-9\.]/g, ''));
			}, 5);
		});



		$('.create-form-components').on('keyup', 'input[required="required"][type="text"], input[required="required"][type="number"], input[required="required"][type="date"], textarea[required="required"]', function () {
			validationFieldsForm($(this), $(this).parents('.form-field').data('type'));
		});

		$('.create-form-components').on('change', 'input[required="required"][type="checkbox"], input[required="required"][type="radio"], select[required="required"]', function () {
			validationFieldsForm($(this), $(this).parents('.form-field').data('type'));
		});

		function validationFieldsForm(field, type) {
			if (type === "checkbox" || type === "radio") {
				if (!field.is(':checked')) {
					field.parents('.form-field').addClass('required');
				} else {
					field.parents('.form-field').removeClass('required');
				}
			} else {
				if (!field.val().trim()) {
					field.parents('.form-field').addClass('required');
				} else {
					field.parents('.form-field').removeClass('required');
				}
			}
		}

		var $zoomPreview = $(".zoom-preview");
		if ($zoomPreview.length) {
			$zoomPreview.parent().removeClass("input-group");
			$zoomPreview.remove();
		}

		var ratings = $(".rating");
		if (ratings.length > 0) ratingStars(ratings);
		function ratingStars(stars) {
			$.each(stars, function (i, obj) {
				var field = $(this).closest(".form-group").find(".rating-value");
				var tgt = $(obj);
				tgt.html("");
				var rating = FLUIGC.stars(tgt, { value: field.val() });
				rating.on("click", function (o) {
					field.val($(this).index() + 1);
				});
			});
		}

		$.each($("[data-date]"), function (i, o) {
			var id = $(o).attr("id");
			FLUIGC.calendar("#" + id);
		});

		$(document).ready(function () {
			$.each($("[data-date]"), function (i, o) {
				var id = $(o).attr("id");
				if ($("#" + id).attr("readonly")) {
					$("#" + id).data('DateTimePicker').disable();
				}
			});
		});
	</script>
</body>

</html>